<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Disponibilidade</title>
  <link rel="icon" href="sprint.png" type="image/png">
  <!-- Importa a biblioteca html2pdf -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <style>
    /* Bloqueia o pull-to-refresh */
    html, body {
      overscroll-behavior-y: none;
    }
    /* Global Clock */
    #global-clock {
      position: fixed;
      top: 10px;
      left: 10px;
      font-size: 24px;
      font-family: 'Courier New', Courier, monospace;
      color: #fff;
      background-color: #000;
      padding: 10px;
      border-radius: 8px;
      z-index: 1001;
      display: none; /* exibido somente ap√≥s iniciar o sprint */
    }
    /* Popup padr√£o (usado para boas-vindas, notifica√ß√µes, etc.) */
    /* Estilos para Popups (boas-vindas, notifica√ß√µes, c√≥pia, PDF e novos pop-ups) */
    .popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      font-size: 16px;
      border-radius: 5px;
      z-index: 1000;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      text-align: center;
    }
    .popup-buttons {
      display: flex;
      justify-content: space-around;
      margin-top: 10px;
    }
    .popup-buttons button {
      padding: 8px 16px;
      font-size: 14px;
      border-radius: 4px;
      cursor: pointer;
      border: none;
    }
    .yes-button {
      background-color: #4CAF50;
      color: #fff;
    }
    .no-button {
      background-color: #f44336;
      color: #fff;
    }
    /* Popup que aparece ao clicar no overlay */
    #body-popup {
      display: none;
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0,0,0,0.85);
      color: #fff;
      padding: 15px 20px;
      border-radius: 8px;
      z-index: 2500;
      font-size: 18px;
      cursor: pointer;
    }
    /* Overlay que intercepta cliques em toda a p√°gina quando o sprint n√£o √© iniciado */
    #clickOverlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: transparent;
      z-index: 2000;
      display: none;
    }
    /* Caixa de Visualiza√ß√£o */
    .preview-box {
      border: 1px solid #ddd;
      padding: 10px;
      margin-top: -10px;
      background-color: #f0f0f0;
      white-space: pre-wrap;
      font-family: monospace;
      font-size: 14px;
    }
    /* Estilos Globais */
    body { 
      font-family: Cambria, Cochin, Georgia, Times, sans-serif; 
    }
    .container { 
      width: 90%; 
      margin: auto; 
    }
    textarea { 
      width: 100%; 
      height: 469px; 
    }
    input[type="text"],
    input[type="date"],
    input[type="number"],
    .supervisor-box {
      width: 100%;
      padding: 5px;
      margin: 4px 0;
      font-size: 14px;
      border: 1px solid #ddd;
      background-color: #f0f0f0;
      text-transform: uppercase;
    }
    .supervisor-option,
    .base-option,
    .turno-option {
      padding: 3px 8px;
      margin: 3px;
      background-color: rgba(255,255,255,0.9);
      border: 1px solid rgba(221,221,221,0.89);
      cursor: pointer;
      display: inline-block;
      font-size: 14px;
      text-align: center;
      border-radius: 4px;
      transition: all 0.3s ease;
    }
    /* ===============================
         Estilos para Status Produtividade por Equipe
    ================================ */
    .equipe {
      border: 2px solid #000;
      border-radius: 10px;
      margin-bottom: 37px;
      background: #fff;
      padding: 11px;
      position: relative;
    }
    .chrome-tab {
      position: absolute;
      top: -31px;
      left: 15px;
      background-color: #000;
      color: white;
      padding: 5px 21px;
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
      font-weight: bold;
      font-size: 14px;
    }
    .equipe-header,
    .equipe-status,
    .equipe-details {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
    }
    /* Cabe√ßalho: Lead */
    .equipe-header h3 {
      margin: 0;
      background-color: #000;
      margin-top: -74px;
      margin-left: 1px;
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
      color: white;
      width: 32%;
      font-size: 22px;
      text-align: center;
    }
    .equipe-header select {
      margin-left: -125px;
      margin-top: -5px;
      padding: 5px;
    }
    /* Status: Produtividade */
    .equipe-status {
      width: 121%;
      margin-top: 4px;
      padding: 0px;
    }
    /* Linha de status com os containers de PRODUTIVA e IMPRODUTIVA */
    .status-row {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      width: 100%;
      margin-bottom: 5px;
    }
    /* Containers de PRODUTIVA e IMPRODUTIVA */
    .produtiva-container {
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 5px;
      margin-top: 10px;
      margin-right: 10px;
      margin-bottom: 10px;
      margin-left: -77px;
      box-sizing: border-box;
    }
    .improdutiva-container {
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 5px;
      margin-top: 10px;
      margin-right: 10px;
      margin-bottom: 10px;
      margin-left: -9px;
      box-sizing: border-box;
    }
    .produtiva-container label,
    .improdutiva-container label {
      margin: 0;
      font-size: 14px;
      white-space: nowrap;
    }
    .produtiva-container input,
    .improdutiva-container input {
      width: 50px;
      padding: 2px;
      text-align: right;
      font-size: 14px;
    }
    /* Detalhes: Tipos e Justificativa */
    .equipe-details {
      width: 100%;
      flex-direction: column;
      margin-top: 10px;
    }
    .equipe-details label {
      display: block;
      margin-bottom: -22px;
      font-size: 14px;
    }
    .equipe-details input {
      width: 96%;
      padding: 5px;
      margin-bottom: 10px;
      text-transform: uppercase;
      font-size: 13px;
    }
    /* Caixa Total */
    .total-box {
      position: absolute;
      background-color: #000;
      color: #fff;
      padding: 4px 8px;
      border-radius: 10px;
      font-size: 18px;
    }
    .total-top-right {
      top: 5px;
      right: 5px;
    }
    .total-top-left {
      top: 5px;
      left: 5px;
    }
    .total-bottom-right {
      bottom: 5px;
      right: 5px;
    }
    .total-bottom-left {
      bottom: 5px;
      left: 5px;
    }
    .supervisor-option.selected,
    .base-option.selected,
    .turno-option.selected {
      background-color: #000;
      color: #fff;
    }
    .supervisor-box {
      width: 100%;
      padding: 6px;
      margin: 5px 0;
      font-size: 14px;
      border: 1px solid #ddd;
      background-color: #f0f0f0;
    }
    /* Bot√µes - Estilo Padr√£o */
    .button-default {
      border: 1px solid #000;
      padding: 8px 16px;
      margin: 5px;
      background-color: #fff;
      cursor: pointer;
      font-size: 14px;
      border-radius: 4px;
      transition: all 0.3s ease;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    .button-default:hover {
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    /* Bot√µes Espec√≠ficos */
    .button-accent {
      background-color: #616964;
      color: #fff;
      padding: 8px 16px;
      margin: 5px;
      cursor: pointer;
      font-size: 14px;
      border-radius: 4px;
      transition: all 0.3s ease;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    .button-enviarWhatsApp {
      background-color: #00b145;
      color: #fff;
      padding: 8px 16px;
      margin: 5px;
      cursor: pointer;
      font-size: 14px;
      border-radius: 4px;
      transition: all 0.3s ease;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    .button-save-pdf {
      background-color: #ffffff;
      border: 1px solid #000000;
      color: #000000;
      padding: 8px 16px;
      margin: 5px;
      cursor: pointer;
      font-size: 14px;
      border-radius: 42px;
      transition: all 0.3s ease;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    .button-clear {
      background-color: #f44336;
      color: #fff;
      padding: 8px 16px;
      margin: 5px;
      cursor: pointer;
      font-size: 14px;
      border-radius: 4px;
      transition: all 0.3s ease;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }
    /* Popup para confirma√ß√£o de c√≥pia */
    #popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px;
      background-color: rgba(0,0,0,0.8);
      color: #fff;
      font-size: 16px;
      border-radius: 5px;
      z-index: 1000;
    }
    /* Bot√£o Reset (Reiniciar Sprint) */
    #reset-button {
      border: 1px solid #000;
      padding: 8px 16px;
      background-color: #000;
      color: #fff;
      cursor: pointer;
      font-size: 20px;
      border-radius: 41px;
      margin: 10px;
      display: block;
      width: fit-content;
      margin-left: auto;
      margin-right: auto;
      z-index: 3000;
      position: relative;
    }
    /* Estilo base para todos os cart√µes de colaborador */
    .colaborador,
    .colaborador-atestado,
    .colaborador-falta,
    .colaborador-novato {
      border: 2px solid #e63946;      /* cor da borda */
      border-radius: 8px;             /* cantos arredondados */
      padding: 12px 16px;             /* espa√ßo interno */
      margin-bottom: 12px;            /* dist√¢ncia para o pr√≥ximo */
      background-color: #fff5f5;      /* leve fundo rosado */
      box-shadow: 0 2px 6px rgba(0,0,0,0.1); /* sombra suave */
    }

    /* Se quiser diferenciar por tipo, use cores distintas */
    .colaborador-atestado {
      border-color: #4caf50;
      background-color: #f5fff5;
    }
    .colaborador-falta {
      border-color: #ff9800;
      background-color: #fff9f5;
    }
    .colaborador-novato {
      border-color: #2196f3;
      background-color: #f5faff;
    }

        /* Container geral do card */
    .colaborador-atestado {
      border-color: #4caf50;
      background-color: #f5fff5;
    }
    .colaborador-falta {
      border-color: #ff9800;
      background-color: #fff9f5;
    }
    .colaborador-novato {
      border-color: #2196f3;
      background-color: #f5faff;
    }

    /* Label sempre √† esquerda, acima da caixa */
    .colaborador-atestado label,
    .colaborador-falta label,
    .colaborador-novato label {
      text-align: left;
      font-weight: 600;
      color: #333;
    }

    /* Inputs e selects ocupam 100% da largura interna */
    .colaborador-atestado input,
    .colaborador-atestado select,
    .colaborador-falta input,
    .colaborador-novato input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }
    * Estilo para cada card de colaborador parado */
    .colaborador {
      display: flex;
      flex-direction: column;
      gap: 12px;            /* espa√ßo entre cada par label+input */
      padding: 16px;
      background: #fafafa;  /* fundo suave */
      border: 1px solid #ddd;
      border-radius: 8px;
      margin-bottom: 12px;
    }

    /* Label sempre acima e alinhado √† esquerda */
    .colaborador label {
      text-align: left;
      font-weight: 600;
      color: #333;
    }

    /* Inputs ocupam 100% da largura interna */
    .colaborador input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-sizing: border-box;
    }
    
    
   /* Container geral dos ‚Äúbot√µes‚Äù de contagem */
    .count-buttons-container {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin: 20px 0;
    }

    /* Cada ‚Äúbot√£o‚Äù de contagem */
    .count-button {
      flex: 1;
      background-color: #000000;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 12px 16px;
      text-align: center;
      cursor: default;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: transform 0.1s;
    }
    .count-button:hover {
      transform: translateY(-2px);
    }

    /* R√≥tulo e valor dentro do bot√£o */
    .count-button .label {
      display: block;
      font-size: 25px;
      font-weight: bold;      /* deixa em negrito */
    }
    .count-button .value {
      display: block;
      font-size: 34px;
      font-weight: bold;
    }
    #update-popup {
      text-align: left;
    }
  </style>
</head>
<body>
 <!-- Overlay que intercepta todos os cliques (iniciar√° ap√≥s a escolha "N√ÉO") -->
  <div id="clickOverlay"></div>
  
  <!-- Global Clock -->
  <div id="global-clock"></div>
  
    <!-- Notas de Atualiza√ß√£o -->
  <div id="update-popup" class="popup">
    <p>
      ‚ö†Ô∏è NOTAS DE ATUALIZA√á√ÉO:<br><br>
      1Ô∏è‚É£ Texto das notas alinhado √† esquerda<br>
      2Ô∏è‚É£ Bot√£o ‚ÄúFechar‚Äù permanece ativo ‚Äî fecha as notas e abre o popup de boas-vindas<br>
      3Ô∏è‚É£ Fun√ß√£o disableAll() ajustada para isentar elementos dentro de #update-popup<br>
      4Ô∏è‚É£ Campo ‚ÄúEquip. Pesada‚Äù inclu√≠do no c√°lculo de equipes em campo<br>
      5Ô∏è‚É£ Sele√ß√£o m√∫ltipla de supervisores com valor refletido no input<br>
      6Ô∏è‚É£ C√°lculo autom√°tico de dias para atestados e novatos funcionando<br>
      7Ô∏è‚É£ Bot√£o ‚ÄúREINICIAR SPRINT!‚Äù reativa todos os campos<br>
      8Ô∏è‚É£ Pop-ups de confirma√ß√£o para sprint, c√≥pia, PDF e WhatsApp ajustados<br>
      9Ô∏è‚É£ Preview em tempo real e gera√ß√£o de mensagem consolidada.<br><br>
      
    <button id="closeUpdate" class="yes-button">Fechar</button>
  </div>
  
  <!-- Popup de Boas-Vindas -->
  <div id="welcome-popup" class="popup">
    <p>Bem-vindo!<br>Deseja iniciar o sprint disponibilidade?</p>
    <div class="popup-buttons">
      <button class="yes-button" onclick="startSprint()">Sim</button>
      <button class="no-button" onclick="handleNoSprint()">N√£o</button>
    </div>
  </div>
  
  <!-- Popup de Notifica√ß√£o para Sim -->
  <div id="yes-notification-popup" class="popup">
    <p>O sprint iniciar√° agora. O contador de tempo foi ativado para medir a sess√£o.</p>
  </div>
  
  <!-- Popup de Notifica√ß√£o para N√£o -->
  <div id="no-notification-popup" class="popup">
    <p>Preenchimento cancelado!</p>
  </div>
  
  <!-- Popup para confirma√ß√£o de c√≥pia -->
  <div id="popup" class="popup">Mensagem Copiada!</div>
  
  <!-- Popup para confirma√ß√£o de PDF salvo -->
  <div id="pdf-popup" class="popup">
    PDF salvo com sucesso!
    <br>
    <button id="pdf-popup-close" onclick="document.getElementById('pdf-popup').style.display='none'" style="margin-top: 10px; padding: 8px 16px; font-size: 14px; border: none; background-color: #4CAF50; color: #fff; border-radius: 4px; cursor: pointer;">Fechar</button>
  </div>
  
  <!-- POPUPS ADICIONAIS -->
  <!-- Popup para "Gerar Mensagem" -->
  <div id="gerar-popup" class="popup">
    <p>Mensagem Gerada!</p>
    <button onclick="document.getElementById('gerar-popup').style.display='none'" style="margin-top: 10px; padding: 8px 16px; font-size: 14px; border: none; background-color: #4CAF50; color: #fff; border-radius: 4px; cursor: pointer;">Fechar</button>
  </div>
  
  <!-- Popup para "Limpar Mensagem" -->
  <div id="limpar-popup" class="popup">
    <p>Mensagem limpa com sucesso!</p>
    <button onclick="document.getElementById('limpar-popup').style.display='none'" style="margin-top: 10px; padding: 8px 16px; font-size: 14px; border: none; background-color: #4CAF50; color: #fff; border-radius: 4px; cursor: pointer;">Fechar</button>
  </div>
  
  <!-- Popup para "Encaminhar via WhatsApp" -->
  <div id="encaminhar-popup" class="popup">
    <p>Mensagem encaminhada com sucesso! Por favor reinicie o sprint!</p>
    <button onclick="document.getElementById('encaminhar-popup').style.display='none'" style="margin-top: 10px; padding: 8px 16px; font-size: 14px; border: none; background-color: #4CAF50; color: #fff; border-radius: 4px; cursor: pointer;">Fechar</button>
  </div>
  
  <!-- Popup que aparece ao clicar no overlay -->
  <div id="body-popup" onclick="this.style.display='none'; event.stopPropagation();">
    ‚ö†Ô∏è ATEN√á√ÉO: Todos os campos est√£o bloqueados!<br>
    Reinicie a p√°gina utilizando o bot√£o "REINICIAR SPRINT".
  </div>
  <!-- Conte√∫do Principal -->
  <div class="container">
    <h2 style="text-align: center; font-size: 25px; font-weight: bold; color: #e63946;">
      MODELO SPRINT/STATUS <br>DISPONIBILIDADE
    </h2>
    <h2 style="text-align: center; font-size: 21px; font-weight: bold; color: #000;">(Vers√£o 3.0)</h2>


    <!-- Se√ß√£o Dados do Turno -->
    <div class="section">
      <h2 style="color: #e63946; font-size: 22px; text-align: center; margin: 20px 0; border-bottom: 5px solid #e63946;">
        Preencha Informa√ß√£o do turno
      </h2>
      <label>üìÖ Data:</label>
      <input type="date" id="data">
      <label>üïí Turno:</label>
      <input type="text" id="turno" maxlength="1" readonly>
      <button class="button-default turno-option" onclick="setTurno('B')">B</button>
      <button class="button-default turno-option" onclick="setTurno('C')">C</button>
      <button class="button-default turno-option" onclick="setTurno('D')">D</button>
      <br><br>
      <label>üè¨ Base:</label>
      <input type="text" id="base" readonly>
      <button class="button-default base-option" onclick="setBase('JACARECANGA')">Jacarecanga</button>
      <button class="button-default base-option" onclick="setBase('MARACANAU')">Maracana√∫</button>
      <button class="button-default base-option" onclick="setBase('MESSEJANA')">Messejana</button>
      <br><br>
      <label>üë§ Supervisor:</label>
      <input type="text" id="supervisor" class="preview-box" readonly>
      <div id="supervisores">
        <button class="button-default supervisor-option" onclick="toggleSupervisor(this)">FRANCISCO CLECIO</button>
        <button class="button-default supervisor-option" onclick="toggleSupervisor(this)">JEFERSON ALVES</button>
        <button class="button-default supervisor-option" onclick="toggleSupervisor(this)">SAMUEL PEIXOTO</button>
        <button class="button-default supervisor-option" onclick="toggleSupervisor(this)">MARCOS FERNANDO</button>
        <button class="button-default supervisor-option" onclick="toggleSupervisor(this)">JOHNY ANGELO</button>
        <button class="button-default supervisor-option" onclick="toggleSupervisor(this)">HELBER CARNEIRO</button>
        <button class="button-default supervisor-option" onclick="toggleSupervisor(this)">ROGERIO AQUINO</button>
      </div>
    </div>
    <h2 style="color: #e63946; font-size: 22px; text-align: center; margin: 20px 0; border-bottom: 5px solid #e63946;">
  Preencha Informa√ß√£o geral
</h2>
<div class="flex">
  <label for="reporteHorario">REPORTE √ÄS:</label>
  <input
    type="text"
    id="reporteHorario"
    maxlength="5"
    placeholder="INSIRA VALOR EM (HH:MM)"
    oninput="formatarHora(this)"
  ><br><br>
  <label for="previsaoEntradas">PREVIS√ÉO ENTRADAS:</label>
  <input
    type="text"
    id="previsaoEntradas"
    maxlength="2"
    placeholder="VALOR FIXO COM BASE NO TURNO"
    oninput="somenteNumeros(this)"
    readonly
  ><br><br>
</div>

<div class="flex">
  <label for="eqpManCorr">EQUIPES MANUTEN√á√ÉO CORRETIVA:</label>
  <input
    type="text"
    id="eqpManCorr"
    maxlength="2"
    placeholder="INSIRA VALOR"
    oninput="recalcularEquipesCampo()"
  ><br><br>

  <label for="eqpLinhaEmerg">EQUIPES LINHA VIVA EMERGENCIA:</label>
  <input
    type="text"
    id="eqpLinhaEmerg"
    maxlength="2"
    placeholder="INSIRA VALOR"
    oninput="recalcularEquipesCampo()"
  ><br><br>

  <label for="eqpPoda">EQUIPES PODA:</label>
  <input
    type="text"
    id="eqpPoda"
    maxlength="2"
    placeholder="INSIRA VALOR"
    oninput="recalcularEquipesCampo()"
  ><br><br>

  <!-- NOVO CAMPO -->
  <label for="eqpPesada">EQUIPES PESADA:</label>
  <input
    type="text"
    id="eqpPesada"
    maxlength="2"
    placeholder="INSIRA VALOR"
    oninput="recalcularEquipesCampo()"
  ><br><br>
</div>

<div class="count-buttons-container">
  <div class="count-button">
    <span class="label">EQP. EM CAMPO üöó</span>
    <span id="equipesCampo" class="value">0</span>
  </div>
  <div class="count-button">
    <span class="label">EQP. PARADAS üö®</span>
    <span id="equipesParadas" class="value">0</span>
  </div>
  <div class="count-button">
    <span class="label">EQP. EXTRAS üöò</span>
    <span id="equipesExtras" class="value">0</span>
  </div>
</div>
    
     <h2 style="color: #e63946; font-size: 22px; text-align: center; margin: 20px 0; border-bottom: 5px solid #e63946;">
        Preencha Informa√ß√£o detalhada
      </h2>

    <!-- Se√ß√£o Eletricistas Parados -->
    <div class="section">
      <h3>üöó Viaturas Paradas</h3>
      <button class="button-default" onclick="adicionarColaborador()">Adicionar</button>
      <button class="button-clear" onclick="removerColaborador()">Remover</button>
      <div id="colaboradoresParados"></div>
      <div class="flex">
        <label for="totalParados">TOTAL EQUIPES PARADAS:</label>
        <input type="text" id="totalParados" readonly class="readonly">
      </div>
    </div>

    <!-- Datalist com a lista de eletricistas (vai ser preenchido via JS) -->
    <datalist id="eletricistasList"></datalist>

    <!-- Se√ß√£o Atestados -->
    <div class="section">
      <h3>üìÉ Atestados</h3>
      <button class="button-default" onclick="adicionarColaboradorAtestado()">Adicionar</button>
      <button class="button-clear" onclick="removerColaboradorAtestado()">Remover</button>
      <div id="colaboradoresAtestado"></div>
      <div class="flex">
        <label for="totalAtestado">TOTAL ELETRICISTAS ATESTADO:</label>
        <input type="text" id="totalAtestado" readonly class="readonly">
      </div>
    </div>

    <!-- Se√ß√£o Faltas -->
    <div class="section">
      <h3>‚ö†Ô∏è Faltas</h3>
      <button class="button-default" onclick="adicionarColaboradorFalta()">Adicionar</button>
      <button class="button-clear" onclick="removerColaboradorFalta()">Remover</button>
      <div id="colaboradoresFalta"></div>
      <div class="flex">
        <label for="totalFalta">TOTAL ELETRICISTAS C/ FALTAS:</label>
        <input type="text" id="totalFalta" readonly class="readonly">
      </div>
    </div>

    <!-- Se√ß√£o Novatos Parados -->
    <div class="section">
      <h3>üÜï Eletricistas Parados</h3>
      <button class="button-default" onclick="adicionarColaboradorNovato()">Adicionar</button>
      <button class="button-clear" onclick="removerColaboradorNovato()">Remover</button>
      <div id="colaboradoresNovato"></div>
      <div class="flex">
        <label for="totalNovato">TOTAL ELETRICISTAS PARADOS:</label>
        <input type="text" id="totalNovato" readonly class="readonly">
      </div>
    </div>
    <h2 style="color: #000000; font-size: 22px; text-align: center; margin: 20px 0; border-bottom: 5px solid #000000;">
        Mensagem de Previsualiza√ß√£o
      </h2>
    <!-- Preview de Mensagem -->
    <div class="section">
      <textarea id="mensagem" class="preview-box" readonly></textarea>
      <div class="flex">
        <button class="button-accent" onclick="gerarMensagem()">Gerar Mensagem</button>
        <button class="button-default" onclick="copiarMensagem()">Copiar</button>
        <button class="button-clear" onclick="limparMensagem()">Limpar</button>
      </div>
    </div>
    
    <!-- Bot√£o Salvar PDF -->
    <button class="button-save-pdf" id="save-pdf-button" onclick="savePdf()">Salvar PDF</button>
    <button class="button-enviarWhatsApp" onclick="handleEnviarWhatsApp()">Encaminhar via WhatsApp</button>
    <br>

    <br><br>
    <!-- Bot√£o para Reiniciar Sprint (sempre clic√°vel) -->
    <button style="text-align: center; font-style: italic; font-family: 'Courier New', Courier, monospace; margin-top: 10px;"  id="reset-button" onclick="resetSprint()">REINICIAR SPRINT!</button>
    <br><br>
 
    <!-- Logo & Assinatura -->
    <div style="text-align:center; margin-top:30px;">
      <img src="https://upload.wikimedia.org/wikipedia/commons/2/22/Enel_Group_logo.svg" alt="Logo ENEL" style="width:150px;">
      <p style="font-style:italic; font-family:'Courier New',monospace; margin-top:10px;">
        ¬© 2025 Emanuel Aguiar (Assistente Administrativo Insourcing - Enel CE)<br>
        Todos os direitos reservados.
      </p>
    </div>
  </div>

  <script>
    function closeUpdatePopup() {
      // Esconde o popup de notas e mostra o de boas-vindas
      document.getElementById('update-popup').style.display = 'none';
      document.getElementById('welcome-popup').style.display = 'block';
    }

    
    // Formata segundos para "Xm e Ys" (verifique se j√° existe antes)
      function formatTime(total) {
        const m = Math.floor(total / 60), s = total % 60;
        let result = "";
        if (m > 0) result += `${m} ${m === 1 ? "minuto" : "minutos"}` + (s > 0 ? " e " : "");
        if (s > 0) result += `${s} ${s === 1 ? "segundo" : "segundos"}`;
        return result;
      }
    
     function formatFullDateTime(date) {
      const meses = ["janeiro","fevereiro","mar√ßo","abril","maio","junho",
                     "julho","agosto","setembro","outubro","novembro","dezembro"];
      let dia      = date.getDate();
      let mes      = meses[date.getMonth()];
      let ano      = date.getFullYear();
      let horas    = date.getHours();
      let minutos  = date.getMinutes();
      let segundos = date.getSeconds();
      let strHoras   = `${horas} ${horas === 1 ? "hora" : "horas"}`;
      let strMinutos = `${minutos} ${minutos === 1 ? "minuto" : "minutos"}`;
      let strSegundos= `${segundos} ${segundos === 1 ? "segundo" : "segundos"}`;
      return `${dia} de ${mes} de ${ano} √†s ${strHoras} e ${strMinutos} e ${strSegundos}`;
    }
    
       // carrega o JSON e popula a vari√°vel eletricistas
    let eletricistas = [];
    window.addEventListener('DOMContentLoaded', () => {
      fetch('./eletricistas.json')
        .then(r => r.json())
        .then(lst => eletricistas = lst)
        .catch(console.error);
    });

    // helper que monta o select com todos os nomes
    function criarSelectEletricistas(className) {
      const sel = document.createElement('select');
      sel.className = className;
      sel.innerHTML =
        '<option value="">‚Äî selecione ‚Äî</option>' +
        eletricistas
          .map(n => `<option value="${n}">${n}</option>`)
          .join('');
      return sel;
    }
    
      window.addEventListener('DOMContentLoaded', () => {
    fetch('./eletricistas.json')
      .then(res => res.json())
      .then(data => {
        eletricistas = data;            // popula a vari√°vel
        const dl = document.getElementById('eletricistasList');
        data.forEach(nome => {
          const opt = document.createElement('option');
          opt.value = nome;
          dl.appendChild(opt);
        });
      })
      .catch(err => console.error('Erro carregando eletricistas:', err));
  });
    
   // Turno/Base/Supervisor
    function setTurno(t){document.getElementById('turno').value=t;document.querySelectorAll('.turno-option').forEach(b=>b.classList.toggle('selected',b.innerText===t));}
    function setBase(base) {
      document.getElementById('base').value = base;
      let baseButtons = document.querySelectorAll('.base-option');
      baseButtons.forEach(button => button.classList.remove('selected'));
      let selectedButton = Array.from(baseButtons).find(button =>
        button.innerText.trim().normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase() === 
        base.trim().normalize("NFD").replace(/[\u0300-\u036f]/g, "").toUpperCase()
      );
      if (selectedButton) selectedButton.classList.add('selected');
    }
    function toggleSupervisor(btn){btn.classList.toggle('selected');const sel=Array.from(document.querySelectorAll('.supervisor-option.selected')).map(b=>b.innerText).join(', ');document.getElementById('supervisor').value=sel;}
    // Popups e overlay
    function showPopup(id, dur=3000) {
      const p = document.getElementById(id);
      p.style.display = 'block';
      setTimeout(()=> p.style.display = 'none', dur);
    }
    function disableAll() {
      document.querySelectorAll('input, button').forEach(el => {
        if (
          el.id === 'reset-button' ||
          el.closest('#welcome-popup') ||
          el.closest('#update-popup')    // <<< Isenta os bot√µes do popup de atualiza√ß√£o
        ) return;
        el.disabled = true;
      });
    }
    function enableAll() {
      document.querySelectorAll('input, button').forEach(el => {
        if (el.id==='reset-button' || el.closest('#welcome-popup')) return;
        el.disabled = false;
      });
    }
      window.onload = () => {
      disableAll();
      // Exibe as Notas de Atualiza√ß√£o
      document.getElementById('update-popup').style.display = 'block';
      // Ativa o evento de fechar
      document.getElementById('closeUpdate')
              .addEventListener('click', closeUpdatePopup);
    };
    function startSprint(){
      enableAll();
      document.getElementById('welcome-popup').style.display='none';
      document.getElementById('global-clock').style.display='block';
      clickOverlay.style.display='none';
      showPopup('yes-notification-popup',2000);
      globalTimerStart = Date.now();
      globalTimerInterval = setInterval(updateClock,1000);
    }
    function handleNoSprint(){
      document.getElementById('welcome-popup').style.display='none';
      clickOverlay.style.display='block';
      showPopup('no-notification-popup',2000);
    }
    function resetSprint(){ location.reload(); }

    // Rel√≥gio global
    let globalTimerStart, globalTimerInterval;
    function updateClock(){
      const sec = Math.floor((Date.now()-globalTimerStart)/1000);
      document.getElementById('global-clock').textContent = formatTime(sec);
    }
    function formatTime(total) {
      const m = Math.floor(total/60), s = total%60;
      return (m>0?m+'m ':'') + s+'s';
    }

    // Helpers de formata√ß√£o
    function formatarHora(el){
      el.value = el.value.replace(/\D/g,'').slice(0,4).replace(/^(\d{2})(\d)/,'$1:$2');
    }
    function somenteNumeros(el){
      el.value = el.value.replace(/\D/g,'').slice(0,2);
    }

    // Supervisores multi-select
    function toggleSupervisor(btn){
      btn.classList.toggle('selected');
      const sel = Array.from(document.querySelectorAll('.supervisor-option.selected'))
                       .map(b=>b.innerText).join(', ');
      document.getElementById('supervisor').value = sel;
    }

    // C√°lculo equipes em campo & paradas
      function recalcularEquipesCampo() {
        const a      = parseInt(document.getElementById('eqpManCorr').value, 10)    || 0;
        const b      = parseInt(document.getElementById('eqpLinhaEmerg').value, 10) || 0;
        const c      = parseInt(document.getElementById('eqpPoda').value, 10)      || 0;
        const pesada = parseInt(document.getElementById('eqpPesada').value, 10)   || 0;
        const total  = a + b + c + pesada;

        // atualiza o span (n√£o mais input)
        document.getElementById('equipesCampo').textContent = total;
        recalcularParadas();
      }

      function recalcularParadas() {
        const prev   = parseInt(document.getElementById('previsaoEntradas').value, 10) || 0;
        const campo  = parseInt(document.getElementById('equipesCampo').textContent, 10) || 0;
        const diff   = prev - campo;
        const extras = campo - prev;

        if (diff >= 0) {
          document.getElementById('equipesParadas').textContent = diff;
          document.getElementById('equipesExtras').textContent = 0;
        } else {
          document.getElementById('equipesParadas').textContent = 0;
          document.getElementById('equipesExtras').textContent = Math.abs(extras);
        }
      }

    // Colaboradores Parados
         function adicionarColaborador() {
      const container = document.getElementById('colaboradoresParados');
      const div = document.createElement('div');
      div.className = 'colaborador';

      // Label + input Placa
      const lblPlaca = document.createElement('label');
      lblPlaca.textContent = 'Placa:';
      const inpPlaca = document.createElement('input');
      inpPlaca.type = 'text';
      inpPlaca.className = 'nomeColaborador';
      inpPlaca.placeholder = 'INSERIR PLACA';
      inpPlaca.maxLength = 7;
      inpPlaca.oninput = function() {
        this.value = this.value
          .toUpperCase()
          .replace(/[^A-Z0-9]/g, '')
          .slice(0,7);
      };

      // Label + input Justificativa
      const lblMotivo = document.createElement('label');
      lblMotivo.textContent = 'Justificativa:';
      const inpMotivo = document.createElement('input');
      inpMotivo.type = 'text';
      inpMotivo.className = 'motivoColaborador';
      inpMotivo.placeholder = 'DESCREVA DETALHES';
      inpMotivo.oninput = function() {
        this.value = this.value.toUpperCase();
      };

      // Empilha label‚Üíinput, label‚Üíinput
      div.append(lblPlaca, inpPlaca, lblMotivo, inpMotivo);
      container.appendChild(div);

      atualizarTotalParados();
    }

    // Remove o √∫ltimo ‚Äúcard‚Äù
    function removerColaborador() {
      const container = document.getElementById('colaboradoresParados');
      // remove o √∫ltimo elemento filho (ignora n√≥s de texto)
      if (container.lastElementChild) {
        container.removeChild(container.lastElementChild);
      }
      atualizarTotalParados();
    }

    // Atualiza a contagem
    function atualizarTotalParados() {
      const count = document.querySelectorAll('#colaboradoresParados .colaborador').length;
      document.getElementById('totalParados').value = count;
    }
    
    // Colaboradores Atestado
    
        function adicionarColaboradorAtestado() {
      const c   = document.getElementById('colaboradoresAtestado');
      const div = document.createElement('div');
      div.className = 'colaborador-atestado';

      // ‚Äî Label + input com autocomplete via datalist ‚Äî
      const lbl = document.createElement('label');
      lbl.textContent = 'Nome:';
      const inp = document.createElement('input');
      inp.type = 'text';
      inp.setAttribute('list', 'eletricistasList');
      inp.className = 'nomeColaboradorAtestado';
      inp.placeholder = 'Selecione‚Ä¶';
      inp.oninput = () => { inp.value = inp.value.toUpperCase(); };

      // ‚Äî Datas e dias ‚Äî
      const lblIni = document.createElement('label');
      lblIni.textContent = 'Data In√≠cio:';
      const inpIni = document.createElement('input');
      inpIni.type = 'date';
      inpIni.className = 'dataInicioAtestado';
      inpIni.onchange = () => atualizarDiasAtestado(inpIni);

      const lblFim = document.createElement('label');
      lblFim.textContent = 'Data Fim:';
      const inpFim = document.createElement('input');
      inpFim.type = 'date';
      inpFim.className = 'previsaoRetornoAtestado';
      inpFim.onchange = () => atualizarDiasAtestado(inpFim);

      const inpDias = document.createElement('input');
      inpDias.type = 'text';
      inpDias.readOnly = true;
      inpDias.className = 'diasAfastado';
      inpDias.placeholder = 'DIAS AFASTADO';
      const lblDias = document.createElement('label');
      lblDias.textContent = 'Total dias afastado:';

      div.append(lbl, inp, lblIni, inpIni, lblFim, inpFim, lblDias, inpDias);
      c.appendChild(div);
      atualizarTotalAtestado();
    }

    function removerColaboradorAtestado(){
      const c = document.getElementById('colaboradoresAtestado');
      if (c.lastChild) c.removeChild(c.lastChild);
      atualizarTotalAtestado();
    }

    function atualizarTotalAtestado(){
      document.getElementById('totalAtestado').value =
        document.querySelectorAll('#colaboradoresAtestado .colaborador-atestado').length;
    }

    // recalcula dias entre Data In√≠cio e Data Fim
    function atualizarDiasAtestado(el){
      const container   = el.parentElement;
      const inicioVal   = container.querySelector('.dataInicioAtestado').value;
      const fimVal      = container.querySelector('.previsaoRetornoAtestado').value;
      if (!inicioVal || !fimVal) return;  // s√≥ calcula quando ambos existirem

      const inicio = new Date(inicioVal);
      const fim    = new Date(fimVal);
      const diff   = Math.ceil((fim - inicio) / (1000*60*60*24));
      container.querySelector('.diasAfastado').value = diff >= 0 ? diff : 0;
      atualizarTotalAtestado();
    }

   // --- FALTAS ---
  function adicionarColaboradorFalta() {
    const c = document.getElementById('colaboradoresFalta');
    const div = document.createElement('div');
    div.className = 'colaborador-falta';

    // Nome (autocomplete via datalist)
    const lblNome = document.createElement('label');
    lblNome.textContent = 'Nome:';
    const inpNome = document.createElement('input');
    inpNome.type = 'text';
    inpNome.setAttribute('list','eletricistasList');
    inpNome.className = 'nomeColaboradorFalta';
    inpNome.placeholder = 'Selecione‚Ä¶';
    inpNome.oninput = () => inpNome.value = inpNome.value.toUpperCase();

    // Data da falta
    const lblData = document.createElement('label');
    lblData.textContent = 'Data da falta:';
    const inpData = document.createElement('input');
    inpData.type = 'date';
    inpData.className = 'dataFalta';
    inpData.onchange = atualizarTotalFalta;

    div.append(lblNome, inpNome, lblData, inpData);
    c.appendChild(div);
    atualizarTotalFalta();
  }

  function removerColaboradorFalta() {
    const c = document.getElementById('colaboradoresFalta');
    if (c.lastChild) c.removeChild(c.lastChild);
    atualizarTotalFalta();
  }

  function atualizarTotalFalta() {
    document.getElementById('totalFalta').value =
      document.querySelectorAll('#colaboradoresFalta .colaborador-falta').length;
  }

        // --- NOVATOS ---
    function adicionarColaboradorNovato() {
      const c = document.getElementById('colaboradoresNovato');
      const div = document.createElement('div');
      div.className = 'colaborador-novato';

      // Nome (autocomplete via datalist)
      const lblNome = document.createElement('label');
      lblNome.textContent = 'Nome:';
      const inpNome = document.createElement('input');
      inpNome.type = 'text';
      inpNome.setAttribute('list','eletricistasList');
      inpNome.className = 'nomeColaboradorNovato';
      inpNome.placeholder = 'Selecione‚Ä¶';
      inpNome.oninput = () => inpNome.value = inpNome.value.toUpperCase();

      // Justificativa / Motivo
      const lblMot = document.createElement('label');
      lblMot.textContent = 'Justificativa:';
      const inpMot = document.createElement('input');
      inpMot.type = 'text';
      inpMot.className = 'motivoNovato';
      inpMot.placeholder = 'DESCREVA DETALHES';
      inpMot.oninput = () => inpMot.value = inpMot.value.toUpperCase();

      // Previs√£o de retorno + c√°lculo de dias
      const lblRet = document.createElement('label');
      lblRet.textContent = 'Previs√£o de Retorno:';
      const inpRet = document.createElement('input');
      inpRet.type = 'date';
      inpRet.className = 'previsaoRetornoNovato';
      inpRet.onchange = () => atualizarDiasNovato(inpRet);

      const inpDias = document.createElement('input');
      inpDias.type = 'text';
      inpDias.readOnly = true;
      inpDias.className = 'diasNovato';
      inpDias.placeholder = 'DIAS';
      const lblDias = document.createElement('label');
      lblDias.textContent = 'Tempo parado:';

      div.append(lblNome, inpNome, lblMot, inpMot, lblRet, inpRet, lblDias, inpDias);
      c.appendChild(div);
      atualizarTotalNovato();
    }

    function removerColaboradorNovato() {
      const c = document.getElementById('colaboradoresNovato');
      if (c.lastChild) c.removeChild(c.lastChild);
      atualizarTotalNovato();
    }

    function atualizarDiasNovato(el) {
      const retorno = new Date(el.value);
      const hoje    = new Date();
      const diff    = Math.ceil((retorno - hoje) / (1000*60*60*24));
      const out     = el.parentElement.querySelector('.diasNovato');
      out.value = diff >= 0 ? diff : 0;
      atualizarTotalNovato();
    }

    function atualizarTotalNovato() {
      document.getElementById('totalNovato').value =
        document.querySelectorAll('#colaboradoresNovato .colaborador-novato').length;
    }
    
    // Gerar mensagem de preview
      function gerarMensagem() {
    // Dados turno
    const t      = document.getElementById('turno').value;
    const dInput = document.getElementById('data').value;
    const d      = dInput ? dInput.split('-').reverse().join('/') : '';
    const b      = document.getElementById('base').value;
    const sup    = document.getElementById('supervisor').value || '';

    // Resumo equipes
    const rep  = document.getElementById('reporteHorario').value;
    const prev = document.getElementById('previsaoEntradas').value;

    // Em campo
    const m      = document.getElementById('eqpManCorr').value   || 0;
    const l      = document.getElementById('eqpLinhaEmerg').value || 0;
    const p      = document.getElementById('eqpPoda').value      || 0;
    const pesada = document.getElementById('eqpPesada').value   || 0;

    // em vez de .value:
    const camp   = document.getElementById('equipesCampo').textContent || 0;
    const par    = document.getElementById('equipesParadas').textContent || 0;
    const extras = document.getElementById('equipesExtras').textContent || 0;  

    let msg = '';
    msg += "---- *INFO. TURNO* ----\n";
    msg += `*TURNO* (${t})\n*DATA:* ${d}\n*BASE:* ${b}\n*SUPERVISORES:* ${sup}\n\n`;

    msg += "---- *DADOS* ----\n";
    msg += `*REPORTE √ÄS* ${rep}\n*PREVIS√ÉO ENTRADAS TOTAL:* (${prev})\n*EQUIPES EM CAMPO:* (${camp})\n\n`;

    msg += "----- *EM CAMPO* ----\n";
    msg += `*EQP. MANUTEN√á√ÉO CORRETIVA:* (${m})\n`;
    msg += `*EQP. LINHA VIVA EMERGENCIAL:* (${l})\n`;
    msg += `*EQP. PODA:* (${p})\n`;
    msg += `*EQP. PESADA:* (${pesada})\n\n`;

    msg += "----- *RESUMO EQUIPES* ----\n";
    msg += `*TOTAL PARADAS:* (${par})\n`;
    msg += `*EQUIPES EXTRAS:* (${extras})\n\n`;

    // Eletricistas parados
    const paras = document.querySelectorAll('#colaboradoresParados .colaborador');
    msg += "---- *VIATURAS PARADAS* ----\n";
    msg += `*TOTAL* (${paras.length})\n\n`;
    paras.forEach(c => {
      const nome = c.querySelector('.nomeColaborador').value;
      const mot  = c.querySelector('.motivoColaborador').value;
      msg += `*PLACA:* ${nome}\n*JUSTIFICATIVA:* ${mot}\n\n`;
    });

    // Atestados
    const ates = document.querySelectorAll('#colaboradoresAtestado .colaborador-atestado');
    msg += "---- *ATESTADOS* ----\n";
    msg += `*TOTAL* (${ates.length})\n\n`;
    ates.forEach(a => {
      const nome   = a.querySelector('.nomeColaboradorAtestado').value;
      const inicio = a.querySelector('.dataInicioAtestado').value.split('-').reverse().join('/');
      const dias   = a.querySelector('.diasAfastado').value;
      const fim    = a.querySelector('.previsaoRetornoAtestado').value.split('-').reverse().join('/');
      msg += `*NOME:* ${nome}\n*IN√çCIO:* ${inicio}\n*DIAS AFASTADO:* ${dias}\n*RETORNO:* ${fim}\n\n`;
    });

    // Faltas
    const falt = document.querySelectorAll('#colaboradoresFalta .colaborador-falta');
    msg += "---- *FALTAS* ----\n";
    msg += `*TOTAL* (${falt.length})\n\n`;
    falt.forEach(f => {
      const nome = f.querySelector('.nomeColaboradorFalta').value;
      const dia  = f.querySelector('.dataFalta').value.split('-').reverse().join('/');
      msg += `*NOME:* ${nome}\n*DATA:* ${dia}\n\n`;
    });

    // Novatos
    const nov = document.querySelectorAll('#colaboradoresNovato .colaborador-novato');
    msg += "---- *ELETRIC. PARADOS* ----\n";
    msg += `*TOTAL* (${nov.length})\n\n`;
    nov.forEach(n => {
      const nome = n.querySelector('.nomeColaboradorNovato').value;
      const mot  = n.querySelector('.motivoNovato').value;
      const ret  = n.querySelector('.previsaoRetornoNovato').value.split('-').reverse().join('/');
      msg += `*NOME:* ${nome}\n*JUSTIFICATIVA:* ${mot}\n*PREVISAO RETORNO:* ${ret}\n\n`;
    });

      // Tempo da sess√£o
      if (globalTimerStart) {
        const sec = Math.floor((Date.now() - globalTimerStart) / 1000);
        msg += `*TEMPO DA SESS√ÉO:* ${formatTime(sec)}\n`;
      }

      // Carimbo de data/hora completa
      const now = new Date();
      msg += `${formatFullDateTime(now)}`;

      // Exibe no textarea e popup
      document.getElementById('mensagem').value = msg.trim();
      showPopup('gerar-popup', 1500);
    }  // ‚Üê Fecha gerarMensagem()

    // Fun√ß√µes auxiliares, todas *fora* de gerarMensagem():
    
    // Copiar e limpar
    function copiarMensagem(){
      const t = document.getElementById('mensagem');
      t.select(); document.execCommand('copy');
      showPopup('popup',1500);
    }
    function limparMensagem(){
      document.getElementById('mensagem').value = '';
      showPopup('limpar-popup',1500);
    }
    function savePdf() {
      gerarMensagem();
      var container = document.querySelector('.container');
      var width = container.offsetWidth;
      var height = container.offsetHeight;
      let now = new Date();
      let data = document.getElementById('data').value;
      let turno = document.getElementById('turno').value;
      let base = document.getElementById('base').value;
      let supervisor = document.getElementById('supervisor').value;
      let fileName = "";
      if (data && turno && base && supervisor) {
          fileName = `${turno}_${base}_${supervisor}_${data}.pdf`;
      } else {
          fileName = `Produtividade_${now.toISOString()}.pdf`;
      }
      function enviarWhatsApp() {
      let mensagem = document.getElementById('mensagem').value;
      let encodedMessage = encodeURIComponent(mensagem);
      window.open(`https://wa.me/?text=${encodedMessage}`, '_blank');
      }

      
      html2pdf(container, {
          margin: 0,
          filename: fileName,
          image: { type: 'jpeg', quality: 0.99 },
          html2canvas: { scale: 2 },
          jsPDF: {
              unit: 'px',
              format: [width, height],
              orientation: 'portrait'
          }
      }).then(() => {
          pdfSaved = true;
          var pdfButton = document.getElementById('save-pdf-button');
          pdfButton.textContent = "PDF j√° salvo";
          pdfButton.style.backgroundColor = "#006400";
          pdfButton.style.color = "#fff";
          pdfButton.style.border = "2px solid #004d00";
          pdfButton.style.boxShadow = "0 0 10px rgba(0,0,0,0.3)";
          document.getElementById('pdf-popup').style.display = 'block';
          setTimeout(() => {
              document.getElementById('pdf-popup').style.display = 'none';
          }, 4000);
      });
    }

    // O overlay (clickOverlay) intercepta cliques em toda a p√°gina.
    // Quando clicado, exibe o popup (body-popup) com a mensagem de aviso.
    document.getElementById('clickOverlay').addEventListener('click', function(e) {
      document.getElementById('body-popup').style.display = 'block';
      // Impede que o clique propague para outras partes (se necess√°rio)
      e.stopPropagation();
    });
    
        function handleEnviarWhatsApp() {
      gerarMensagem(); // Garante que a mensagem est√° atualizada
      const mensagem = document.getElementById('mensagem').value.trim();

      if (!mensagem) {
        alert("A mensagem est√° vazia. Gere a mensagem antes de enviar.");
        return;
      }

      const encodedMessage = encodeURIComponent(mensagem);

      // Tenta abrir WhatsApp Web (desktop) ou app (mobile)
      const url = `https://wa.me/?text=${encodedMessage}`;
      window.open(url, '_blank');

      // Exibe popup de confirma√ß√£o
      showPopup('encaminhar-popup', 3000);
    }
    
        // Fun√ß√£o para definir o turno e prever a entrada
    function setTurno(t) {
      document.getElementById('turno').value = t;
      document.querySelectorAll('.turno-option').forEach(b => b.classList.toggle('selected', b.innerText === t));

      // Configura√ß√£o da previs√£o de entrada conforme o turno
      let previsao = '';
      if (t === 'B') {
        previsao = '22'; // Turno B
      } else if (t === 'C') {
        previsao = '14'; // Turno C
      } else if (t === 'D') {
        previsao = '06'; // Turno D
      }

      // Preencher a previs√£o de entrada e tornar o campo somente leitura
      document.getElementById('previsaoEntradas').value = previsao;
      document.getElementById('previsaoEntradas').readOnly = true;
    }


  </script>
</body>
</html>
